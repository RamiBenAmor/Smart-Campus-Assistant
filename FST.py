fst_data = {
  "Mathematics": {
    "description": "From the main entrance (Rue Habib Chatti), walk straight along the central building. The Department of Mathematics is in the building to the left after the Khawarizmi Computing Center, located in the northeast corner of the campus.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "1st floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "2nd floor",
      "class 19": "2nd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "3rd floor",
      "class 23": "3rd floor",
      "class 24": "3rd floor",
      "class 25": "4th floor",
      "class 26": "4th floor",
      "class 27": "4th floor",
      "class 28": "4th floor",
      "class 29": "4th floor"
    }
  },
  "Computer Science": {
    "description": "From the main entrance, turn left and walk to the end of the campus. The Computer Science Department is in the Informatics Block, near the sports hall in the northwest corner.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "2nd floor",
      "class 19": "2nd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "3rd floor",
      "class 23": "3rd floor",
      "class 24": "3rd floor",
      "class 25": "4th floor",
      "class 26": "4th floor",
      "class 27": "4th floor",
      "class 28": "4th floor",
      "class 29": "4th floor"
    }
  },
  "Physics": {
    "description": "From the main entrance, walk straight toward Amphi B, then turn left. The Physics Department is in the TP and TD Physics blocks, behind the central mosque.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "2nd floor",
      "class 19": "2nd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "3rd floor",
      "class 23": "3rd floor",
      "class 24": "4th floor",
      "class 25": "4th floor",
      "class 26": "4th floor",
      "class 27": "4th floor",
      "class 28": "4th floor"
    }
  },
  "Biology": {
    "description": "From the main entrance, take the main road to the right, pass the central building, and turn left. The Biology Department is located at the southeast edge of campus, sharing space with the Geology building.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "2nd floor",
      "class 19": "3rd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "3rd floor",
      "class 23": "3rd floor",
      "class 24": "4th floor",
      "class 25": "4th floor",
      "class 26": "4th floor",
      "class 27": "4th floor",
      "class 28": "4th floor"
    }
  },
  "Preparatory": {
    "description": "From the main entrance, walk straight to reach Amphi B. The Preparatory Department is just next to it, in the center of the campus.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "3rd floor",
      "class 19": "3rd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "4th floor",
      "class 23": "4th floor",
      "class 24": "4th floor",
      "class 25": "4th floor"
    }
  },
  "Chemistry": {
    "description": "From the main entrance, walk straight and turn left after Amphi B. The Chemistry Department is in the large marked building in the southwest corner, under the Tunisian Chemical Society sign.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "1st floor",
      "class 14": "1st floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "2nd floor",
      "class 18": "2nd floor",
      "class 19": "3rd floor",
      "class 20": "3rd floor",
      "class 21": "3rd floor",
      "class 22": "3rd floor",
      "class 23": "4th floor",
      "class 24": "4th floor",
      "class 25": "4th floor",
      "class 26": "4th floor"
    }
  },
  "Geology": {
    "description": "From the main entrance, walk straight and turn left toward the Chemistry Department. The Geology Department is next to it, slightly south-central on campus.",
    "floors": {
      "class 1": "Ground floor",
      "class 2": "Ground floor",
      "class 3": "Ground floor",
      "class 4": "Ground floor",
      "class 5": "Ground floor",
      "class 6": "Ground floor",
      "class 7": "Ground floor",
      "class 8": "Ground floor",
      "class 9": "1st floor",
      "class 10": "1st floor",
      "class 11": "1st floor",
      "class 12": "1st floor",
      "class 13": "2nd floor",
      "class 14": "2nd floor",
      "class 15": "2nd floor",
      "class 16": "2nd floor",
      "class 17": "3rd floor",
      "class 18": "3rd floor",
      "class 19": "3rd floor",
      "class 20": "3rd floor",
      "class 21": "4th floor",
      "class 22": "4th floor",
      "class 23": "4th floor"
    }
  }
}

import tensorflow as tf
tf.debugging.set_log_device_placement(True)
from chatbot_interface.app import compare_those_two_declaration, filtered_text
import nltk
from nltk.corpus import stopwords
from nltk.tokenize import word_tokenize
from nltk.stem import PorterStemmer
from sentence_transformers import SentenceTransformer
stop_words = set(stopwords.words('english'))
stemmer = PorterStemmer()
model = SentenceTransformer('all-MiniLM-L6-v2')

departments = ["Mathematics", "Physics", "Computer Science", "Preparatory", "Biology", "Chemistry"]

# Stem all the department names
stemmed_departments = {stemmer.stem(department) for department in departments}

# Custom stop words: remove all words not in the stemmed department list
def filter_departments_with_stemmer(user_input):
    # Convert input to lowercase, tokenize, and stem
    words = nltk.word_tokenize(user_input.lower())
    
    # Stem the words and filter out those not in the department list
    filtered_words = [word for word in words if stemmer.stem(word) in stemmed_departments]
    
    # Join the remaining words back into a string
    return ' '.join(filtered_words)
def filter_class(user_input,clas) :
  stemmed_class = {stemmer.stem(x) for x in clas}
  words = nltk.word_tokenize(user_input.lower())
  filtered_words = [word for word in words if stemmer.stem(word) in stemmed_class]
  return ' '.join(filtered_words)


def try_to_find_dep(text, list_of_description):
    comparision = []
    text = filtered_text(text)
    for x in list_of_description:
        
        score = compare_those_two_declaration(text,x)
        comparision.append([ x, score])
    
    comparision = sorted(comparision, key=lambda item: item[1])
    
    return comparision[-1][0]
def try_to_find_class_floor(text, list_of_description) :
    comparision = []
    text = filtered_text(text)
    for x in list_of_description:
        
        score = compare_those_two_declaration(text,x)
        comparision.append([ x, score])
    
    comparision = sorted(comparision, key=lambda item: item[1])
    
    return comparision[-1][0]

inut="give me location of Deparatement of Mathematics class 6"
res=try_to_find_dep(inut,departments)
#print(fst_data[res]["description"])
res1=try_to_find_class_floor(inut,fst_data[res]["floors"])
print(res1)
#print(fst_data[res]["floors"][res1])